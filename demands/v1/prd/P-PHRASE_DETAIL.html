<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>语习集 - 短语详情</title>
    <script src="https://unpkg.byted-static.com/coze/space_ppt_lib/1.0.3-alpha.12/lib/tailwindcss.js"></script>
    <script src="https://unpkg.byted-static.com/fortawesome/fontawesome-free/6.7.2/js/all.min.js" data-auto-replace-svg="nest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#7c3aed',
                        tertiary: '#059669',
                        success: '#10b981',
                        danger: '#ef4444',
                        info: '#3b82f6',
                        'text-primary': '#1f2937',
                        'text-secondary': '#6b7280',
                        'bg-card': '#ffffff',
                        'bg-secondary': '#f8fafc',
                        'border-light': '#e5e7eb'
                    },
                    fontFamily: {
                        'sans': ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif']
                    },
                    boxShadow: {
                        'card': '0 2px 8px rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 4px 16px rgba(0, 0, 0, 0.1)'
                    },
                    borderRadius: {
                        'card': '16px'
                    }
                }
            }
        }
    </script>
    <style>
        .safe-top {
            padding-top: env(safe-area-inset-top);
        }
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
        
        .recording-animation {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
        }
        
        /* 示例卡片样式已移除折叠功能 */
        
        .pronunciation-btn.active {
            background-color: #2563eb;
            color: white;
        }
        
        .mastery-badge {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
    </style>
</head>
<body class="bg-bg-secondary font-sans">
    <!-- 状态栏 -->
    <div id="status-bar" class="bg-white safe-top">
        <div class="flex justify-between items-center px-6 py-2 text-sm font-medium text-gray-900">
            <span>9:41</span>
            <div class="flex items-center space-x-1">
                <i class="fas fa-signal text-xs"></i>
                <i class="fas fa-wifi text-xs"></i>
                <i class="fas fa-battery-three-quarters text-xs"></i>
            </div>
        </div>
    </div>

    <!-- 主要内容区域 -->
    <div id="main-content" class="pb-6">
        <!-- 顶部导航栏 -->
        <header id="top-header" class="bg-white px-6 py-4 shadow-sm">
            <div id="header-content" class="flex items-center justify-between">
                <!-- 返回按钮 -->
                <button id="back-btn" class="w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center">
                    <i class="fas fa-arrow-left text-gray-600 text-sm"></i>
                </button>
                
                <!-- 标题 -->
                <h1 id="page-title" class="text-lg font-semibold text-text-primary">短语详情</h1>
                
                <!-- 右侧操作按钮 -->
                <div id="header-actions" class="flex items-center space-x-2">
                    <button id="favorite-btn" class="w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center">
                        <i class="far fa-heart text-gray-600 text-sm"></i>
                    </button>
                    <button id="share-btn" class="w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center">
                        <i class="fas fa-share text-gray-600 text-sm"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- 短语基本信息 -->
        <!-- 短语基本信息 -->
        <section id="phrase-basic" class="mx-6 mt-6">
            <div id="phrase-content">
                <!-- 短语文本 -->
                <div id="phrase-text-section" class="mb-6">
                    <h2 id="phrase-text" class="text-2xl font-bold text-text-primary mb-2">Could you please...</h2>
                    <p id="phrase-meaning" class="text-lg text-text-secondary">请问你可以...吗？</p>
                </div>
                
                <!-- 发音区域 -->
                <div id="pronunciation-section" class="mb-6">
                    <h3 id="pronunciation-title" class="text-sm font-semibold text-text-primary mb-3">标准发音</h3>
                    
                    <!-- 发音类型切换 -->
                    <div id="pronunciation-type" class="flex items-center space-x-2 mb-4">
                        <button id="british-btn" class="px-4 py-2 bg-gray-100 text-gray-700 text-sm rounded-lg pronunciation-btn active">
                            <i class="fas fa-flag-uk mr-1"></i>英式
                        </button>
                        <button id="american-btn" class="px-4 py-2 bg-gray-100 text-gray-700 text-sm rounded-lg pronunciation-btn">
                            <i class="fas fa-flag-us mr-1"></i>美式
                        </button>
                    </div>
                    
                    <!-- 发音播放器 -->
                    <div id="audio-player" class="flex items-center space-x-3">
                        <button id="play-btn" class="w-12 h-12 bg-primary rounded-full flex items-center justify-center">
                            <i class="fas fa-play text-white text-lg"></i>
                        </button>
                        <div id="audio-info" class="flex-1">
                            <div id="audio-progress" class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                <div id="audio-progress-bar" class="bg-primary h-2 rounded-full w-0 transition-all duration-300"></div>
                            </div>
                            <div id="audio-time" class="flex justify-between text-xs text-text-secondary">
                                <span id="current-time">0:00</span>
                                <span id="total-time">0:03</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 发音要点 -->
                <div id="pronunciation-tips" class="mb-6">
                    <h3 id="tips-title" class="text-sm font-semibold text-text-primary mb-3">发音要点</h3>
                    <div id="tips-content" class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <p id="tips-text" class="text-sm text-blue-800">注意"could"的弱读发音，重音应落在"please"的第一个音节上，结尾的"..."表示语气的委婉。</p>
                    </div>
                </div>
                
                <!-- 词性和场景标签 -->
                <div id="tags-section">
                    <div id="tags-container" class="flex items-center justify-between">
                        <div id="part-of-speech" class="flex items-center space-x-2">
                            <span class="text-sm text-text-secondary">词性：</span>
                            <span id="pos-tag" class="px-3 py-1 bg-purple-50 text-purple-600 text-sm rounded-full">动词短语</span>
                        </div>
                        <div id="scene-tags" class="flex items-center space-x-2">
                            <span class="text-sm text-text-secondary">场景：</span>
                            <span id="scene-tag" class="px-3 py-1 bg-blue-50 text-blue-600 text-sm rounded-full">日常用语</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 发音练习 -->
        <section id="pronunciation-practice" class="mx-6 mt-6">
            <div id="practice-content">
                <h3 id="practice-title" class="text-lg font-semibold text-text-primary mb-4">发音练习</h3>
                
                <!-- 录音按钮 -->
                <div id="recording-section" class="text-center mb-6">
                    <button id="record-btn" class="w-14 h-14 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-3">
                        <i id="record-icon" class="fas fa-microphone text-white text-xl"></i>
                    </button>
                    <p id="record-status" class="text-sm text-text-secondary">点击开始录音</p>
                    <div id="recording-timer" class="text-xl font-bold text-red-500 mt-2 hidden">00:00</div>
                </div>
                
                <!-- AI反馈区域 -->
                <div id="ai-feedback" class="hidden">
                    <h4 id="feedback-title" class="text-sm font-semibold text-text-primary mb-3">AI发音反馈</h4>
                    <div id="feedback-content" class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div id="feedback-score" class="flex items-center justify-between mb-3">
                            <span class="text-sm text-green-800">发音评分：</span>
                            <span id="score-value" class="text-lg font-bold text-green-600">85分</span>
                        </div>
                        <div id="feedback-suggestions">
                            <p id="feedback-text" class="text-sm text-green-800 mb-2">发音清晰，语调自然！建议：</p>
                            <ul id="feedback-list" class="text-sm text-green-700 space-y-1">
                                <li>• "could"的发音可以更轻柔一些</li>
                                <li>• "please"的重音位置很标准</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 场景示例 -->
        <section id="scene-examples" class="mx-6 mt-6">
            <div id="examples-content">
                <h3 id="examples-title" class="text-lg font-semibold text-text-primary mb-4">场景示例</h3>
                
                <!-- 示例1 -->
                <div id="example-1" class="border border-gray-200 rounded-lg mb-4">
                    <div id="example-1-header" class="p-4 flex items-center justify-between bg-gray-50">
                        <div id="example-1-info">
                            <h4 id="example-1-title" class="text-sm font-semibold text-text-primary">请求帮助</h4>
                            <p id="example-1-desc" class="text-xs text-text-secondary">在需要他人帮助时使用</p>
                        </div>
                    </div>
                    <div id="example-1-content" class="px-4 py-4 border-t border-gray-100">
                        <div id="example-1-dialogue" class="mb-4">
                            <p id="example-1-english" class="text-sm font-medium text-text-primary mb-2">Could you please help me carry this bag?</p>
                            <p id="example-1-chinese" class="text-sm text-text-secondary mb-3">请问你可以帮我拿一下这个包吗？</p>
                            <button id="example-1-audio" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-play text-gray-600 text-sm"></i>
                            </button>
                        </div>
                        <div id="example-1-usage" class="bg-gray-50 rounded-lg p-3">
                            <p class="text-xs text-text-secondary">使用场景：当你需要他人帮助时，这是一个非常礼貌的表达方式。</p>
                        </div>
                    </div>
                </div>
                
                <!-- 示例2 -->
                <div id="example-2" class="border border-gray-200 rounded-lg mb-4">
                    <div id="example-2-header" class="p-4 flex items-center justify-between bg-gray-50">
                        <div id="example-2-info">
                            <h4 id="example-2-title" class="text-sm font-semibold text-text-primary">询问信息</h4>
                            <p id="example-2-desc" class="text-xs text-text-secondary">向他人询问信息时使用</p>
                        </div>
                    </div>
                    <div id="example-2-content" class="px-4 py-4 border-t border-gray-100">
                        <div id="example-2-dialogue" class="mb-4">
                            <p id="example-2-english" class="text-sm font-medium text-text-primary mb-2">Could you please tell me the way to the station?</p>
                            <p id="example-2-chinese" class="text-sm text-text-secondary mb-3">请问你可以告诉我去车站的路吗？</p>
                            <button id="example-2-audio" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-play text-gray-600 text-sm"></i>
                            </button>
                        </div>
                        <div id="example-2-usage" class="bg-gray-50 rounded-lg p-3">
                            <p class="text-xs text-text-secondary">使用场景：在陌生的地方向当地人询问路线或其他信息时使用。</p>
                        </div>
                    </div>
                </div>
                
                <!-- 示例3 -->
                <div id="example-3" class="border border-gray-200 rounded-lg">
                    <div id="example-3-header" class="p-4 flex items-center justify-between bg-gray-50">
                        <div id="example-3-info">
                            <h4 id="example-3-title" class="text-sm font-semibold text-text-primary">请求许可</h4>
                            <p id="example-3-desc" class="text-xs text-text-secondary">请求他人允许时使用</p>
                        </div>
                    </div>
                    <div id="example-3-content" class="px-4 py-4 border-t border-gray-100">
                        <div id="example-3-dialogue" class="mb-4">
                            <p id="example-3-english" class="text-sm font-medium text-text-primary mb-2">Could you please open the window?</p>
                            <p id="example-3-chinese" class="text-sm text-text-secondary mb-3">请问你可以打开窗户吗？</p>
                            <button id="example-3-audio" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-play text-gray-600 text-sm"></i>
                            </button>
                        </div>
                        <div id="example-3-usage" class="bg-gray-50 rounded-lg p-3">
                            <p class="text-xs text-text-secondary">使用场景：在需要改变环境或使用他人物品时，礼貌地请求许可。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 开始测试 -->
        <section id="start-test" class="mx-6 mt-6">
            <button id="test-btn" class="w-full bg-gradient-to-r from-primary to-secondary text-white font-semibold py-4 rounded-lg shadow-md">
                <i class="fas fa-graduation-cap mr-2"></i>
                开始测试
            </button>
        </section>

        <!-- 掌握状态 -->
        <section id="mastery-status" class="mx-6 mt-6 mb-8">
            <div id="status-content" class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                <div id="status-info" class="flex items-center">
                    <div id="status-icon" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-clock text-gray-600 text-sm"></i>
                    </div>
                    <div>
                        <h3 id="status-title" class="text-sm font-semibold text-text-primary">学习状态</h3>
                        <p id="status-text" class="text-xs text-text-secondary">待学习</p>
                    </div>
                </div>
                <div id="mastery-badge" class="px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full hidden">
                    <i class="fas fa-check mr-1"></i>已掌握
                </div>
            </div>
        </section>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 解析URL参数的辅助函数
            function getUrlParams() {
                const params = {};
                const queryString = window.location.search.substring(1);
                const urlParams = new URLSearchParams(queryString);
                
                for(const [key, value] of urlParams.entries()) {
                    params[key] = value;
                }
                return params;
            }

            // 模拟短语数据
            const phraseData = {
                "phrase1": {
                    english: "Could you please...",
                    chinese: "请问你可以...吗？",
                    partOfSpeech: "动词短语",
                    scene: "日常用语",
                    difficulty: "入门",
                    pronunciationTips: "注意\"could\"的弱读发音，重音应落在\"please\"的第一个音节上，结尾的\"...\"表示语气的委婉。",
                    examples: [
                        {
                            title: "请求帮助",
                            desc: "在需要他人帮助时使用",
                            english: "Could you please help me carry this bag?",
                            chinese: "请问你可以帮我拿一下这个包吗？",
                            usage: "使用场景：当你需要他人帮助时，这是一个非常礼貌的表达方式。"
                        },
                        {
                            title: "询问信息",
                            desc: "向他人询问信息时使用",
                            english: "Could you please tell me the way to the station?",
                            chinese: "请问你可以告诉我去车站的路吗？",
                            usage: "使用场景：在陌生的地方向当地人询问路线或其他信息时使用。"
                        },
                        {
                            title: "请求许可",
                            desc: "请求他人允许时使用",
                            english: "Could you please open the window?",
                            chinese: "请问你可以打开窗户吗？",
                            usage: "使用场景：在需要改变环境或使用他人物品时，礼貌地请求许可。"
                        }
                    ]
                },
                "phrase2": {
                    english: "I'm looking for...",
                    chinese: "我在找...",
                    partOfSpeech: "动词短语",
                    scene: "购物",
                    difficulty: "入门",
                    pronunciationTips: "注意\"looking\"的发音，重音在第一个音节，结尾的\"for\"要轻读。",
                    examples: [
                        {
                            title: "商店购物",
                            desc: "在商店寻找商品时使用",
                            english: "I'm looking for a red shirt.",
                            chinese: "我在找一件红色的衬衫。",
                            usage: "使用场景：在商店里告诉店员你想要找的商品。"
                        },
                        {
                            title: "寻找地点",
                            desc: "在某个地方寻找特定地点时使用",
                            english: "I'm looking for the restroom.",
                            chinese: "我在找洗手间。",
                            usage: "使用场景：在商场、机场等公共场所寻找特定设施时使用。"
                        },
                        {
                            title: "寻找人",
                            desc: "在人群中寻找特定的人时使用",
                            english: "I'm looking for my friend.",
                            chinese: "我在找我的朋友。",
                            usage: "使用场景：在聚会、活动中寻找特定的人时使用。"
                        }
                    ]
                }
            };

            // 获取URL参数
            const params = getUrlParams();
            const phraseId = params.phraseId || 'phrase1'; // 默认显示第一个短语

            // 加载短语数据
            function loadPhraseData(id) {
                const data = phraseData[id];
                if (!data) return;

                // 更新基本信息
                document.querySelector('#phrase-text').textContent = data.english;
                document.querySelector('#phrase-meaning').textContent = data.chinese;
                document.querySelector('#pos-tag').textContent = data.partOfSpeech;
                document.querySelector('#scene-tag').textContent = data.scene;
                document.querySelector('#tips-text').textContent = data.pronunciationTips;

                // 更新示例
                data.examples.forEach((example, index) => {
                    const exampleNumber = index + 1;
                    document.querySelector(`#example-${exampleNumber}-title`).textContent = example.title;
                    document.querySelector(`#example-${exampleNumber}-desc`).textContent = example.desc;
                    document.querySelector(`#example-${exampleNumber}-english`).textContent = example.english;
                    document.querySelector(`#example-${exampleNumber}-chinese`).textContent = example.chinese;
                    document.querySelector(`#example-${exampleNumber}-usage p`).textContent = example.usage;
                });
            }

            // 初始化页面数据
            loadPhraseData(phraseId);

            // 返回按钮
            document.querySelector('#back-btn').addEventListener('click', function() {
                window.history.back();
            });

            // 收藏按钮
            document.querySelector('#favorite-btn').addEventListener('click', function() {
                const icon = this.querySelector('i');
                if (icon.classList.contains('far')) {
                    icon.classList.remove('far');
                    icon.classList.add('fas');
                    icon.style.color = '#ef4444';
                } else {
                    icon.classList.remove('fas');
                    icon.classList.add('far');
                    icon.style.color = '#6b7280';
                }
            });

            // 分享按钮
            document.querySelector('#share-btn').addEventListener('click', function() {
                window.location.href = `P-SHARE.html?phraseId=${phraseId}`;
            });

            // 发音类型切换
            document.querySelector('#british-btn').addEventListener('click', function() {
                document.querySelector('#american-btn').classList.remove('active');
                this.classList.add('active');
            });

            document.querySelector('#american-btn').addEventListener('click', function() {
                document.querySelector('#british-btn').classList.remove('active');
                this.classList.add('active');
            });

            // 发音播放
            let isPlaying = false;
            document.querySelector('#play-btn').addEventListener('click', function() {
                const icon = this.querySelector('i');
                if (!isPlaying) {
                    icon.classList.remove('fa-play');
                    icon.classList.add('fa-pause');
                    isPlaying = true;
                    
                    // 模拟音频播放进度
                    let progress = 0;
                    const progressBar = document.querySelector('#audio-progress-bar');
                    const interval = setInterval(() => {
                        progress += 10;
                        progressBar.style.width = progress + '%';
                        if (progress >= 100) {
                            clearInterval(interval);
                            icon.classList.remove('fa-pause');
                            icon.classList.add('fa-play');
                            isPlaying = false;
                            progressBar.style.width = '0%';
                        }
                    }, 300);
                } else {
                    icon.classList.remove('fa-pause');
                    icon.classList.add('fa-play');
                    isPlaying = false;
                    document.querySelector('#audio-progress-bar').style.width = '0%';
                }
            });

            // 录音功能
            let isRecording = false;
            let recordingTimer = 0;
            let timerInterval;

            document.querySelector('#record-btn').addEventListener('click', function() {
                const icon = document.querySelector('#record-icon');
                const status = document.querySelector('#record-status');
                const timer = document.querySelector('#recording-timer');

                if (!isRecording) {
                    // 开始录音
                    isRecording = true;
                    recordingTimer = 0;
                    icon.classList.remove('fa-microphone');
                    icon.classList.add('fa-stop');
                    this.classList.add('recording-animation');
                    status.textContent = '点击停止录音';
                    timer.classList.remove('hidden');
                    
                    // 开始计时
                    timerInterval = setInterval(() => {
                        recordingTimer++;
                        const minutes = Math.floor(recordingTimer / 60);
                        const seconds = recordingTimer % 60;
                        timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    }, 1000);
                } else {
                    // 停止录音
                    isRecording = false;
                    icon.classList.remove('fa-stop');
                    icon.classList.add('fa-microphone');
                    this.classList.remove('recording-animation');
                    status.textContent = '点击开始录音';
                    timer.classList.add('hidden');
                    clearInterval(timerInterval);
                    
                    // 显示AI反馈
                    setTimeout(() => {
                        document.querySelector('#ai-feedback').classList.remove('hidden');
                    }, 500);
                }
            });

            // 示例音频播放
            for (let i = 1; i <= 3; i++) {
                document.querySelector(`#example-${i}-audio`).addEventListener('click', function() {
                    const icon = this.querySelector('i');
                    if (icon.classList.contains('fa-play')) {
                        icon.classList.remove('fa-play');
                        icon.classList.add('fa-pause');
                        setTimeout(() => {
                            icon.classList.remove('fa-pause');
                            icon.classList.add('fa-play');
                        }, 2000);
                    }
                });
            }

            // 开始测试按钮
            document.querySelector('#test-btn').addEventListener('click', function() {
                window.location.href = `P-TEST.html?phraseId=${phraseId}`;
            });

            // 检查是否已掌握该短语（模拟）
            function checkMasteryStatus() {
                // 这里可以根据实际的学习记录来判断
                const isMastered = Math.random() > 0.7; // 模拟70%的概率已掌握
                
                if (isMastered) {
                    document.querySelector('#status-text').textContent = '已掌握';
                    document.querySelector('#mastery-badge').classList.remove('hidden');
                    document.querySelector('#mastery-badge').classList.add('mastery-badge');
                    document.querySelector('#status-icon').innerHTML = '<i class="fas fa-check text-green-600 text-sm"></i>';
                    document.querySelector('#status-icon').classList.remove('bg-gray-100');
                    document.querySelector('#status-icon').classList.add('bg-green-100');
                }
            }

            // 页面加载时检查掌握状态
            checkMasteryStatus();
        });
    </script>
</body>
</html>