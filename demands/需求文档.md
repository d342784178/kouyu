# 语习集APP - 产品需求文档

## 1. 产品概述

### 1.1 产品定位
语习集是一款AI驱动的英语口语学习Web应用，采用场景化学习方式，帮助用户在真实对话场景中掌握实用口语表达。产品聚焦日常高频英语短语，通过AI对话练习、智能评测、场景模拟等方式，提升用户的英语口语应用能力。

### 1.2 目标用户
- **学生群体**：希望提升英语口语表达能力，应对日常交流和考试需求
- **职场人士**：需要在工作中进行简单英文沟通，或为职业发展做准备
- **出国人群**：急需掌握旅行、生活场景中的实用短语
- **英语爱好者**：希望通过多样化方式提升口语水平

### 1.3 核心价值
- **场景化学习**：在真实对话场景中学习英语，避免"学了不会用"
- **AI个性化**：AI根据用户水平生成对话、评测发音、提供个性化建议
- **即时反馈**：实时评测、即时纠错，快速提升学习效果
- **碎片化学习**：每节10分钟，适合碎片化时间学习

---

## 2. 功能模块

### 2.1 首页模块

#### 2.1.1 功能描述
作为用户进入APP后的主要入口，提供学习概览、核心功能导航和个性化推荐。

#### 2.1.2 功能详述

| 功能ID | 功能名称 | 功能描述 | 优先级 |
|--------|---------|---------|--------|
| F-HOME-001 | 搜索框 | 支持搜索短语，输入框带搜索图标，聚焦时显示边框高亮 | P0 |
| F-HOME-002 | 用户头像 | 右上角显示用户头像，点击进入个人中心 | P1 |
| F-HOME-003 | 学习进度卡片 | 展示今日学习进度，包含进度环、已学短语数、学习时长、连续天数 | P0 |
| F-HOME-004 | 复习提醒 | 渐变背景卡片，显示待复习短语数量，点击跳转复习页面 | P0 |
| F-HOME-005 | 推荐场景 | 展示2个推荐场景卡片，显示场景名称、分类、难度、描述 | P0 |
| F-HOME-006 | 场景分类入口 | 2x2网格布局，4大场景分类（日常问候、购物消费、餐饮服务、旅行出行） | P0 |

#### 2.1.3 交互流程
1. 用户打开APP，进入首页
2. 展示学习进度、复习提醒、推荐场景
3. 用户可选择搜索短语、查看推荐场景、选择场景分类
4. 点击场景卡片进入场景详情页

---

### 2.2 短语库模块

#### 2.2.1 功能描述
集中展示所有英语短语，支持按场景筛选和搜索，帮助用户系统学习高频短语。

#### 2.2.2 功能详述

| 功能ID | 功能名称 | 功能描述 | 优先级 |
|--------|---------|---------|--------|
| F-PHRASE-001 | 场景标签栏 | 横向滚动标签栏，支持按场景筛选（全部、日常问候、购物消费、餐饮服务、旅行出行） | P0 |
| F-PHRASE-002 | 短语列表 | 卡片式列表，显示英文短语、中文释义、场景标签、难度标签、播放按钮 | P0 |
| F-PHRASE-003 | 短语搜索 | 支持按关键词搜索短语 | P1 |
| F-PHRASE-004 | 音频播放 | 点击播放按钮播放短语发音 | P0 |
| F-PHRASE-005 | 短语详情 | 点击卡片进入短语详情页，展示完整信息 | P0 |

#### 2.2.3 短语数据结构
```typescript
interface Phrase {
  id: string              // 短语ID
  english: string         // 英文短语
  chinese: string         // 中文释义
  partOfSpeech: string    // 词性
  scene: string           // 所属场景
  difficulty: string      // 难度（入门/进阶/中级）
  pronunciationTips: string // 发音提示
  audioUrl: string | null // 音频URL
}
```

---

### 2.3 场景学习模块

#### 2.3.1 功能描述
提供真实对话场景学习，包含场景对话、解析、高频单词，帮助用户在具体场景中掌握实用表达。

#### 2.3.2 功能详述

| 功能ID | 功能名称 | 功能描述 | 优先级 |
|--------|---------|---------|--------|
| F-SCENE-001 | 场景列表 | 展示所有场景，按分类分组，显示场景名称、难度、学习时长 | P0 |
| F-SCENE-002 | 场景详情 | 展示场景信息（名称、分类、难度、描述）、对话内容、高频单词 | P0 |
| F-SCENE-003 | 对话展示 | 对话气泡形式展示，区分说话人，支持单句播放 | P0 |
| F-SCENE-004 | 播放全部 | 一键播放完整对话音频 | P0 |
| F-SCENE-005 | 对话解析 | 针对核心问答提供详细解析，包含同问题不同回答 | P0 |
| F-SCENE-006 | 高频单词 | 展示场景核心单词，包含音标、释义、例句、音频 | P0 |
| F-SCENE-007 | 开始测试 | 底部固定按钮，点击进入场景测试 | P0 |

#### 2.3.3 场景数据结构
```typescript
interface Scene {
  id: string              // 场景ID
  name: string            // 场景名称
  category: string        // 场景分类
  description: string     // 场景描述
  difficulty: string      // 难度
  duration: number        // 学习时长（分钟）
  dialogue: Dialogue      // 对话内容
  vocabulary: Vocabulary[] // 高频单词
}

interface Dialogue {
  full_audio_url: string  // 完整音频
  duration: number        // 音频时长
  rounds: DialogueRound[] // 对话回合
}

interface DialogueRound {
  round_number: number
  content: DialogueContent[]
  analysis?: QAAnalysis   // 问答解析
}
```

---

### 2.4 场景测试模块

#### 2.4.1 功能描述
提供多种题型测试，检验用户对场景学习内容的掌握程度，包含选择题、填空题、开放式对话。

#### 2.4.2 功能详述

| 功能ID | 功能名称 | 功能描述 | 优先级 |
|--------|---------|---------|--------|
| F-TEST-001 | 测试选择 | 展示可用测试列表，显示测试类型、难度、题目数量 | P0 |
| F-TEST-002 | 进度条 | 显示答题进度（百分比、当前题号/总题数） | P0 |
| F-TEST-003 | 题型标识 | 卡片展示当前题型（选择题/填空题/问答题/开放式对话） | P0 |
| F-TEST-004 | 选择题 | 单选题，选择正确答案，选择后即时反馈 | P0 |
| F-TEST-005 | 填空题 | 支持文本输入和语音输入，提交后AI评测 | P0 |
| F-TEST-006 | 语音输入 | 填空题支持语音识别，自动转文字 | P0 |
| F-TEST-007 | AI评测 | 后端调用AI大模型评测答案，返回评分、分析、建议 | P0 |
| F-TEST-008 | 评测动画 | 提交后显示全屏加载动画，禁止操作 | P0 |
| F-TEST-009 | 评测结果 | 展示评测结果（正确/错误、AI分析、参考答案、改进建议） | P0 |
| F-TEST-010 | 导航控制 | 必须作答后才能进入下一题，评测期间禁用导航 | P0 |
| F-TEST-011 | 开放式对话 | AI驱动的多轮对话练习，支持语音输入 | P0 |
| F-TEST-012 | 对话评测 | 对话结束后AI分析整体表现，给出评分和建议 | P0 |

#### 2.4.3 测试数据结构
```typescript
interface SceneTest {
  id: string              // 测试ID
  sceneId: string         // 关联场景ID
  type: string            // 题型（choice/fill_blank/qa/open）
  order: number           // 题目顺序
  content: TestContent    // 题目内容
}

interface TestContent {
  question: string        // 题目
  options?: string[]      // 选项（选择题）
  answer: string          // 参考答案
}
```

#### 2.4.4 填空题交互流程
1. 用户选择输入方式（文本/语音）
2. 文本输入：在文本框输入答案
3. 语音输入：点击录音按钮，语音转文字
4. 显示答案预览
5. 点击提交，显示全屏加载动画
6. 后端AI评测答案
7. 显示评测结果（正确/错误、分析、建议）
8. 解锁"下一题"按钮

#### 2.4.5 开放式对话交互流程
1. 用户选择测试，进入开放式对话
2. 系统分析题目，展示场景、角色、对话目标
3. 用户选择角色和难度等级
4. AI生成初始对话并自动播放语音
5. 用户通过语音或文本回复
6. AI根据回复生成下一轮对话
7. 完成指定轮数后，AI分析整体表现
8. 展示评测结果和详细分析

---

### 2.5 音频播放模块

#### 2.5.1 功能描述
统一管理音频播放，支持单句播放、连续播放、播放控制。

#### 2.5.2 功能详述

| 功能ID | 功能名称 | 功能描述 | 优先级 |
|--------|---------|---------|--------|
| F-AUDIO-001 | 单句播放 | 点击播放按钮播放单句音频 | P0 |
| F-AUDIO-002 | 播放全部 | 一键播放完整对话 | P0 |
| F-AUDIO-003 | 播放控制 | 支持暂停、继续播放 | P0 |
| F-AUDIO-004 | 播放状态 | 显示当前播放状态（播放中/暂停） | P0 |

---

### 2.6 底部导航模块

#### 2.6.1 功能描述
提供全局导航，方便用户在不同功能模块间切换。

#### 2.6.2 功能详述

| 功能ID | 功能名称 | 功能描述 | 优先级 |
|--------|---------|---------|--------|
| F-NAV-001 | 首页Tab | 点击进入首页 | P0 |
| F-NAV-002 | 短语库Tab | 点击进入短语库 | P0 |
| F-NAV-003 | 场景学习Tab | 点击进入场景列表 | P0 |
| F-NAV-004 | 我的Tab | 点击进入个人中心 | P1 |
| F-NAV-005 | 激活状态 | 当前页面Tab高亮显示 | P0 |

---

## 3. 页面规格

### 3.1 页面清单

| 页面ID | 页面名称 | 路径 | 核心功能 |
|--------|---------|------|---------|
| P-HOME | 首页 | `/` | 学习进度、推荐场景、场景分类入口 |
| P-PHRASE_LIBRARY | 短语库 | `/phrase-library` | 短语浏览、筛选、搜索 |
| P-PHRASE_DETAIL | 短语详情 | `/phrase-detail` | 短语学习、发音练习 |
| P-SCENE_LIST | 场景列表 | `/scene-list` | 场景分类浏览 |
| P-SCENE_DETAIL | 场景详情 | `/scene-detail/[id]` | 对话学习、解析、高频单词 |
| P-SCENE_TEST | 场景测试选择 | `/scene-test/[id]` | 测试列表、测试选择 |
| P-SCENE_TEST_QUESTION | 场景测试题 | `/scene-test/[id]/[testId]` | 答题、评测、结果展示 |

### 3.2 页面布局规范

#### 3.2.1 通用布局
```
┌─────────────────────────────┐
│ 状态栏 (safe-top)            │
├─────────────────────────────┤
│ 顶部导航栏                    │
├─────────────────────────────┤
│                             │
│      主要内容区域              │
│    (mx-6, 左右边距 24px)      │
│                             │
├─────────────────────────────┤
│ 底部导航栏 (fixed bottom)     │
│ (safe-bottom, h-16, 64px)   │
└─────────────────────────────┘
```

#### 3.2.2 间距规范
- 页面水平边距：`mx-6` (24px)
- 卡片内边距：`p-4` (16px) / `p-6` (24px)
- 元素间距：`space-y-3` (12px) / `space-y-4` (16px)
- 组件间距：`mt-4` (16px) / `mt-6` (24px)

---

## 4. 交互规范

### 4.1 点击反馈
- 卡片点击：`scale(0.98)` 后恢复
- 按钮点击：视觉状态变化
- 列表项：整行可点击

### 4.2 状态切换
- 标签切换：背景色 + 文字色变化
- 选项选择：边框高亮 + 填充标记
- 导航激活：主色高亮

### 4.3 录音交互
- 点击录音按钮 → 显示脉冲动画
- 录音中 → 红色指示器 + 波形动画
- 录音完成 → 结果显示 + AI评价

### 4.4 加载状态
- 提交答案 → 全屏遮罩 + 旋转动画 + 文字提示
- AI生成中 → 三个圆点脉冲动画
- 页面加载 → 骨架屏或Loading Spinner

### 4.5 过渡动画
- 卡片悬停：`translateY(-2px)` + 阴影增强
- 弹窗出现：`scale(0.9→1)` + `opacity(0→1)`
- 页面切换：淡入淡出

---

## 5. 数据需求

### 5.1 数据表结构

详见设计文档《数据模型设计》。

### 5.2 API接口

| 接口 | 方法 | 描述 |
|-----|------|------|
| `/api/phrases` | GET | 获取所有短语 |
| `/api/phrases/[id]` | GET | 获取短语详情 |
| `/api/scenes` | GET | 获取场景列表 |
| `/api/scenes/[id]` | GET | 获取场景详情 |
| `/api/scenes/[id]/tests` | GET | 获取场景测试列表 |
| `/api/fill-blank/evaluate` | POST | 填空题AI评测 |
| `/api/open-test/initiate` | POST | 初始化开放式对话 |
| `/api/open-test/continue` | POST | 继续对话 |
| `/api/open-test/analyze` | POST | 分析对话表现 |
| `/api/audio` | POST | 音频播放 |

---

## 6. 非功能需求

### 6.1 性能要求
- 首屏加载时间 < 2秒
- 音频播放延迟 < 500ms
- AI评测响应时间 < 5秒

### 6.2 兼容性
- 支持Chrome、Safari、Edge等现代浏览器
- 支持移动端浏览器
- 语音识别需要Webkit内核浏览器（Chrome/Safari）

### 6.3 安全要求
- 用户数据加密存储
- API接口防刷限流
- 音频文件安全访问

---

## 7. 附录

### 7.1 更新记录
| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0 | 2026-02-18 | 初始版本，包含首页、短语库、场景学习、场景测试 |

### 7.2 相关文档
- 交互风格说明文档: `/design/交互风格说明文档.md`
- 设计文档: `/demands/设计文档.md`
- 原型图: `/demands/原型图/`
